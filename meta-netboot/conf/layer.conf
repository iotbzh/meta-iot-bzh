# We have a conf and classes directory, add to BBPATH
BBPATH .= ":${LAYERDIR}"

# We have recipes-* directories, add to BBFILES
BBFILES += "${LAYERDIR}/recipes-*/*/*.bb \
	${LAYERDIR}/recipes-*/*/*.bbappend"

BBFILE_COLLECTIONS += "meta-netboot"
BBFILE_PATTERN_meta-netboot = "^${LAYERDIR}/"
BBFILE_PRIORITY_meta-netboot = "20"

##################################################################
# add initrd image and add new format for rootfs to enable NBD sharing
IMAGE_FSTYPES += "ext4"
INITRAMFS_IMAGE += "initramfs-netboot-image"

# specific initrd format for U-boot based images
IMAGE_CLASSES += "${@'image_types_uboot' if (d.getVar("KERNEL_IMAGETYPE", True) == "uImage") else ''}"
INITRAMFS_FSTYPES += "${@'ext4.gz.u-boot' if (d.getVar("KERNEL_IMAGETYPE", True) == "uImage") else 'ext4.gz'}"
